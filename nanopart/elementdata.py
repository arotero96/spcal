import re

from typing import List, Tuple


def parse_formula(formula: str) -> List[Tuple[str, int]]:
    validre = re.compile("([A-Z][a-z]?|[0-9]+)+")
    tokenre = re.compile("[A-Z][a-z]?|[0-9]+")
    if not validre.fullmatch(formula):
        return None

    tokens = tokenre.findall(formula)
    symbols: List[Tuple[str, int]] = []
    for token in tokens:
        try:
            n = int(token)
            symbols[-1] = (symbols[-1][0], n)
        except ValueError:
            symbols.append((token, 1))
        except IndexError:
            return None
    return symbols


symbols_from_names = {
    "Hydrogen": "H",
    "Helium": "He",
    "Lithium": "Li",
    "Beryllium": "Be",
    "Boron": "B",
    "Carbon": "C",
    "Nitrogen": "N",
    "Oxygen": "O",
    "Fluorine": "F",
    "Neon": "Ne",
    "Sodium": "Na",
    "Magnesium": "Mg",
    "Aluminum": "Al",
    "Silicon": "Si",
    "Phosphorus": "P",
    "Sulfur": "S",
    "Chlorine": "Cl",
    "Argon": "Ar",
    "Potassium": "K",
    "Calcium": "Ca",
    "Scandium": "Sc",
    "Titanium": "Ti",
    "Vanadium": "V",
    "Chromium": "Cr",
    "Manganese": "Mn",
    "Iron": "Fe",
    "Cobalt": "Co",
    "Nickel": "Ni",
    "Copper": "Cu",
    "Zinc": "Zn",
    "Gallium": "Ga",
    "Germanium": "Ge",
    "Arsenic": "As",
    "Selenium": "Se",
    "Bromine": "Br",
    "Krypton": "Kr",
    "Rubidium": "Rb",
    "Strontium": "Sr",
    "Yttrium": "Y",
    "Zirconium": "Zr",
    "Niobium": "Nb",
    "Molybdenum": "Mo",
    "Technetium": "Tc",
    "Ruthenium": "Ru",
    "Rhodium": "Rh",
    "Palladium": "Pd",
    "Silver": "Ag",
    "Cadmium": "Cd",
    "Indium": "In",
    "Tin": "Sn",
    "Antimony": "Sb",
    "Tellurium": "Te",
    "Iodine": "I",
    "Xenon": "Xe",
    "Cesium": "Cs",
    "Barium": "Ba",
    "Lanthanum": "La",
    "Cerium": "Ce",
    "Praseodymium": "Pr",
    "Neodymium": "Nd",
    "Promethium": "Pm",
    "Samarium": "Sm",
    "Europium": "Eu",
    "Gadolinium": "Gd",
    "Terbium": "Tb",
    "Dysprosium": "Dy",
    "Holmium": "Ho",
    "Erbium": "Er",
    "Thulium": "Tm",
    "Ytterbium": "Yb",
    "Lutetium": "Lu",
    "Hafnium": "Hf",
    "Tantalum": "Ta",
    "Tungsten": "W",
    "Rhenium": "Re",
    "Osmium": "Os",
    "Iridium": "Ir",
    "Platinum": "Pt",
    "Gold": "Au",
    "Mercury": "Hg",
    "Thallium": "Tl",
    "Lead": "Pb",
    "Bismuth": "Bi",
    "Polonium": "Po",
    "Radon": "Rn",
    "Radium": "Ra",
    "Actinium": "Ac",
    "Thorium": "Th",
    "Protactinium": "Pa",
    "Uranium": "U",
    "Neptunium": "Np",
    "Plutonium": "Pu",
    "Americium": "Am",
    "Curium": "Cm",
    "Berkelium": "Bk",
    "Californium": "Cf",
}

density = {
    "B": 2.34,
    "C": 2.26,
    "Mg": 1.74,
    "Al": 2.7,
    "Si": 2.33,
    "P": 1.82,
    "S": 2.07,
    "Cl": 3.21,
    "Ar": 0.86,
    "K": 1.78,
    "Ca": 1.55,
    "Sc": 3.00,
    "Ti": 4.54,
    "V": 6.11,
    "Cr": 7.19,
    "Mn": 7.43,
    "Fe": 7.87,
    "Co": 8.9,
    "Ni": 8.9,
    "Cu": 8.96,
    "Zn": 7.13,
    "Ga": 5.91,
    "Ge": 5.32,
    "As": 5.72,
    "Se": 4.79,
    "Br": 3.12,
    "Kr": 3.75,
    "Rb": 1.63,
    "Sr": 2.54,
    "Y": 4.47,
    "Zr": 6.51,
    "Nb": 8.57,
    "Mo": 10.22,
    "Tc": 11.5,
    "Ru": 12.37,
    "Rh": 12.41,
    "Pd": 12.02,
    "Ag": 10.5,
    "Cd": 8.65,
    "In": 7.31,
    "Sn": 7.31,
    "Sb": 6.68,
    "Te": 4.93,
    "I": 6.24,
    "Xe": 5.9,
    "Cs": 1.87,
    "Ba": 3.59,
    "La": 6.15,
    "Ce": 6.77,
    "Pr": 6.77,
    "Nd": 7.01,
    "Pm": 7.3,
    "Sm": 7.52,
    "Eu": 5.24,
    "Gd": 7.9,
    "Tb": 8.23,
    "Dy": 8.55,
    "Ho": 8.8,
    "Er": 9.07,
    "Tm": 9.32,
    "Yb": 6.9,
    "Lu": 9.84,
    "Hf": 13.31,
    "Ta": 16.65,
    "W": 19.35,
    "Re": 21.04,
    "Os": 22.6,
    "Ir": 22.4,
    "Pt": 21.45,
    "Au": 19.32,
    "Hg": 13.55,
    "Tl": 11.85,
    "Pb": 11.35,
    "Bi": 9.75,
    "Po": 9.3,
    "Rn": 9.73,
    "Ra": 5.5,
    "Ac": 10.07,
    "Th": 15.4,
    "Pa": 11.72,
    "U": 19.0,
    "Np": 20.2,
    "Pu": 13.67,
    "Am": 19.84,
    "Cm": 13.5,
    "Bk": 14.78,
    "Cf": 15.1,
}

molarmass = {
    "H": 1.0079,
    "He": 4.0026,
    "Li": 6.941,
    "Be": 9.0122,
    "B": 10.811,
    "C": 12.0107,
    "N": 14.0067,
    "O": 15.9994,
    "F": 18.9984,
    "Ne": 20.1797,
    "Na": 22.9897,
    "Mg": 24.305,
    "Al": 26.9815,
    "Si": 28.0855,
    "P": 30.9738,
    "S": 32.065,
    "Cl": 35.453,
    "Ar": 39.948,
    "K": 39.0983,
    "Ca": 40.078,
    "Sc": 44.9559,
    "Ti": 47.867,
    "V": 50.9415,
    "Cr": 51.9961,
    "Mn": 54.938,
    "Fe": 55.845,
    "Co": 58.9332,
    "Ni": 58.6934,
    "Cu": 63.546,
    "Zn": 65.39,
    "Ga": 69.723,
    "Ge": 72.64,
    "As": 74.9216,
    "Se": 78.96,
    "Br": 79.904,
    "Kr": 83.8,
    "Rb": 85.4678,
    "Sr": 87.62,
    "Y": 88.9059,
    "Zr": 91.224,
    "Nb": 92.9064,
    "Mo": 95.94,
    "Tc": 98,
    "Ru": 101.07,
    "Rh": 102.9055,
    "Pd": 106.42,
    "Ag": 107.8682,
    "Cd": 112.411,
    "In": 114.818,
    "Sn": 118.71,
    "Sb": 121.76,
    "Te": 127.6,
    "I": 126.9045,
    "Xe": 131.293,
    "Cs": 132.9055,
    "Ba": 137.327,
    "La": 138.9055,
    "Ce": 140.116,
    "Pr": 140.9077,
    "Nd": 144.24,
    "Pm": 145,
    "Sm": 150.36,
    "Eu": 151.964,
    "Gd": 157.25,
    "Tb": 158.9253,
    "Dy": 162.5,
    "Ho": 164.9303,
    "Er": 167.259,
    "Tm": 168.9342,
    "Yb": 173.04,
    "Lu": 174.967,
    "Hf": 178.49,
    "Ta": 180.9479,
    "W": 183.84,
    "Re": 186.207,
    "Os": 190.23,
    "Ir": 192.217,
    "Pt": 195.078,
    "Au": 196.9665,
    "Hg": 200.59,
    "Tl": 204.3833,
    "Pb": 207.2,
    "Bi": 208.9804,
    "Po": 209,
    "At": 210,
    "Rn": 222,
    "Fr": 223,
    "Ra": 226,
    "Ac": 227,
    "Th": 232.0381,
    "Pa": 231.0359,
    "U": 238.0289,
    "Np": 237,
    "Pu": 244,
    "Am": 243,
    "Cm": 247,
    "Bk": 247,
    "Cf": 251,
    "Es": 252,
    "Fm": 257,
    "Md": 258,
    "No": 259,
    "Lr": 262,
    "Rf": 261,
    "Db": 262,
    "Sg": 266,
    "Bh": 264,
    "Hs": 277,
    "Mt": 268,
    "Rg": 272,
}
